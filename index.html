<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="Style.css">
  </head>
    <body>
    <!-- Ваш HTML остаётся без изменений -->
    
    <body>
    <header>
      <div class="top_bg">
        <div class="header_top">
          <img src="Img/header/F1.png" height="85" width="300">
          <div>
            <a class="top_footer_text" href="login.html">Вход</a>
            <img src="Img/header/F2.png" height="80" width="80">
          </div>
        </div>
    </div>
    <div class="bot_bg">
        <div class="header_bot">
          <a class="bot_footer_text">Главная</a>
          <a class="bot_footer_text" href="Mematicka_page1.html">Мематека</a>
          <a class="bot_footer_text" href="Random.html" >Рандом</a>
          <a class="bot_footer_text">Коллекция</a>
          <a class="bot_footer_text" href="Eg.html">ЕГЭ</a>
          <a class="bot_footer_text" href="About.html">О нас</a>
        </div>
    </div>
    </header>

    <main>
      <section>
         <div class="contener">
        <div class="redactor">
            <div class="red_zone" id="red-zone">
                <div class="image" id="meme-image"></div>
                <textarea id="meme-text" placeholder="Введите текст мема"></textarea>
            </div>
        </div>
        <div class="buttons_conts">
            <button id="create-btn" class="green_buttons">Создать мем</button>
            <button id="upload-btn" class="gray_buttons">Загрузить изображение</button>
            <input type="file" id="image-upload" accept="image/*" style="display: none;">
        </div>
    </div>
        </section>
      </section>
      <section>
        <div class="contener">
          <p class="zag">Шаблоны</p>
          <div class="blanks">
            <img src="Img/Blanks/B1.png" >
            <img src="Img/Blanks/B2.png" >
            <img src="Img/Blanks/B3.png" >
            <img src="Img/Blanks/B4.png" >
            <img src="Img/Blanks/B5.png" >
            <img src="Img/Blanks/B6.png" >
            <img src="Img/Blanks/B7.png" >
            <img src="Img/Blanks/B8.png" >
          </div>
        </div>
      </section>
      <canvas id="meme-canvas" style="display:none;"></canvas>
    </main>
    <footer>
      <div class="footers">
      <img src="Img/Foter/log.png" height="85" width="300">
      <div>
        <p class="zag">© MemGen.ru 2025</p>
        <a class="zag f" href="About.html">Информация о нас </a>
      </div>
    </div>
    </footer>
 <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <script>
         // Часть 1: Загрузка изображения
        document.addEventListener('DOMContentLoaded', function() {
            const uploadBtn = document.getElementById('upload-btn');
            const imageUpload = document.getElementById('image-upload');
            const imageContainer = document.getElementById('meme-image');
            
            uploadBtn.addEventListener('click', function() {
                imageUpload.click();
            });
            
            imageUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        imageContainer.style.backgroundImage = `url(${event.target.result})`;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Часть 2: Создание мема (ваш код)
            const createBtn = document.getElementById('create-btn');
            const redZone = document.getElementById('red-zone');
            
            createBtn.addEventListener('click', function() {
                html2canvas(redZone, {
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true,
                    onclone: function(clonedDoc) {
                        const clonedTextarea = clonedDoc.getElementById('meme-text');
                        if (clonedTextarea) {
                              clonedTextarea.style.marginTop = '40px';
        clonedTextarea.style.display = 'block';
        clonedTextarea.style.width = '100%'; // На всю ширину
        clonedTextarea.style.background = 'transparent'; // Прозрачный фон
        clonedTextarea.style.border = 'none'; // Убрать рамку
        clonedTextarea.style.color = 'white'; // Цвет текста
        clonedTextarea.style.textAlign = 'center'; // Центрирование
         clonedTextarea.style.zindex = '1000'; // Центрирование
                        }
                    }
                }).then(canvas => {
                    const ctx = canvas.getContext('2d');
                    const text = document.getElementById('meme-text').value;
                    
                    if (text) {
                        ctx.font = 'bold 24px Impact';
                        ctx.textAlign = 'center';
                        ctx.fillStyle = 'white';
                        ctx.strokeStyle = 'black';
                        ctx.lineWidth = 2;
                        
                        // Позиция текста (регулируйте последнее число)
                        const textX = canvas.width / 2;
                        const textY = canvas.height - 50; // Текст ближе к низу
                        
                        ctx.strokeText(text, textX, textY);
                        ctx.fillText(text, textX, textY);
                    }
                    
                    const link = document.createElement('a');
                    link.download = 'meme.png';
                    link.href = canvas.toDataURL('image/png');
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }).catch(err => {
                    console.error('Ошибка:', err);
                    alert('Ошибка при создании мема');
                });
            });
        });
    </script>
</body>
</html>
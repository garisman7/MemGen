<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="Style.css">
  </head>
    <body>
    <!-- Ваш HTML остаётся без изменений -->
    
    <body>
    <header>
      <div class="top_bg">
        <div class="header_top">
          <img src="Img/header/F1.png" height="85" width="300">
          <div>
            <a class="top_footer_text" href="login.html">Вход</a>
            <img src="Img/header/F2.png" height="80" width="80">
          </div>
        </div>
    </div>
    <div class="bot_bg">
        <div class="header_bot">
          <a class="bot_footer_text">Главная</a>
          <a class="bot_footer_text" href="Mematicka_page1.html">Мематека</a>
          <a class="bot_footer_text" href="Random.html" >Рандом</a>
          <a class="bot_footer_text">Коллекция</a>
          <a class="bot_footer_text" href="Eg.html">ЕГЭ</a>
          <a class="bot_footer_text" href="About.html">О нас</a>
        </div>
    </div>
    </header>

    <main>
      <section>
            <div class="contener">
          <p class="zag">Создать мем</p>
          <div class="redactor">
            <div class="red_zone">
              <div class="image" id="meme-image"></div>
              <textarea id="meme-text" placeholder="Текст"></textarea>
            </div>
          </div>
          <div class="buttons_conts">
            <button id="create-btn" class="green_buttons">Создать</button>
            <button id="upload-btn" class="gray_buttons">Загрузить изображение</button>
            <input type="file" id="image-upload" accept="image/*" style="display: none;">
          </div>
        </div>
        </section>
      </section>
      <section>
        <div class="contener">
          <p class="zag">Шаблоны</p>
          <div class="blanks">
            <img src="Img/Blanks/B1.png" >
            <img src="Img/Blanks/B2.png" >
            <img src="Img/Blanks/B3.png" >
            <img src="Img/Blanks/B4.png" >
            <img src="Img/Blanks/B5.png" >
            <img src="Img/Blanks/B6.png" >
            <img src="Img/Blanks/B7.png" >
            <img src="Img/Blanks/B8.png" >
          </div>
        </div>
      </section>
      <canvas id="meme-canvas" style="display:none;"></canvas>
    </main>
    <footer>
      <div class="footers">
      <img src="Img/Foter/log.png" height="85" width="300">
      <div>
        <p class="zag">© MemGen.ru 2025</p>
        <a class="zag f" href="About.html">Информация о нас </a>
      </div>
    </div>
    </footer>
 <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <script>
      // Функция для кнопки "Загрузить изображение"
      document.getElementById('upload-btn').addEventListener('click', function() {
        document.getElementById('image-upload').click();
      });

      document.getElementById('image-upload').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(event) {
            const image = document.getElementById('meme-image');
            image.style.backgroundImage = `url(${event.target.result})`;
          };
          reader.readAsDataURL(file);
        }
      });

      // Функция для кнопки "Создать"
      document.getElementById('create-btn').addEventListener('click', function() {
        const canvas = document.getElementById('meme-canvas');
        const redZone = document.querySelector('.red_zone');
        const imageDiv = document.getElementById('meme-image');
        const text = document.getElementById('meme-text').value;
        
        // Установим размеры canvas
        canvas.width = redZone.offsetWidth;
        canvas.height = redZone.offsetHeight;
        
        const ctx = canvas.getContext('2d');
        
        // Очищаем canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Получаем фоновое изображение
        const backgroundImage = new Image();
        const bgUrl = imageDiv.style.backgroundImage.slice(4, -1).replace(/"/g, "");
        
        if (bgUrl && bgUrl !== 'none') {
          backgroundImage.src = bgUrl;
          backgroundImage.onload = function() {
            // Рисуем изображение
            ctx.drawImage(backgroundImage, 0, 0, canvas.width, canvas.height);
            
            // Добавляем текст
            ctx.font = '30px Arial';
            ctx.fillStyle = 'white';
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.textAlign = 'center';
            
            // Разбиваем текст на строки, если он слишком длинный
            const lines = text.split('\n');
            const lineHeight = 35;
            const startY = canvas.height - (lines.length * lineHeight) - 20;
            
            lines.forEach((line, i) => {
              const y = startY + (i * lineHeight);
              ctx.strokeText(line, canvas.width / 2, y);
              ctx.fillText(line, canvas.width / 2, y);
            });
            
            // Сохраняем как изображение
            // Сохраняем как изображение
            saveCanvasAsImage();
          };
        } else {
          // Если нет фонового изображения, просто добавляем текст
          ctx.fillStyle = '#f0f0f0';
          ctx.fillRect(0, 0, canvas.width, canvas.height);
          
          ctx.font = '30px Arial';
          ctx.fillStyle = 'black';
          ctx.textAlign = 'center';
          
          const lines = text.split('\n');
          const lineHeight = 35;
          const startY = canvas.height / 2 - (lines.length * lineHeight) / 2;
          
          lines.forEach((line, i) => {
            const y = startY + (i * lineHeight);
            ctx.fillText(line, canvas.width / 2, y);
          });
          
          saveCanvasAsImage();
        }
      });

      function saveCanvasAsImage() {
        const canvas = document.getElementById('meme-canvas');
        const link = document.createElement('a');
        link.download = 'meme.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      }

      // Добавляем обработчики для шаблонов
      // Добавляем обработчики для шаблонов
      // Добавляем обработчики для шаблонов
      // Добавляем обработчики для шаблонов
      document.querySelectorAll('.blanks img').forEach(img => {
        img.addEventListener('click', function() {
          document.getElementById('meme-image').style.backgroundImage = `url(${this.src})`;
        });
      });
    </script>
</body>
</html>